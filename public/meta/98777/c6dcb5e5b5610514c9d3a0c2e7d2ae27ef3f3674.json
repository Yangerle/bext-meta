{"type":"javascript","name":"纪念模式","version":"4","tags":["美化脚本"],"synopsis":"bextBar 版本的 纪念模式，让网页变为黑白样式","detail":"<p class=\"ql-align-center\">bextBar 示例脚本，增加 <span style=\"background-color: rgb(102, 163, 224); color: rgb(255, 255, 255);\"> 纪念模式 </span> 按钮。</p><p class=\"ql-align-center\">使用 CSS <a rel=\"noopener noreferrer\" href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/filter\">filter</a> 滤镜实现。</p><p class=\"ql-align-center\"><br></p><p class=\"ql-align-center\">这个脚本运行需要 WebView 53+ 内核。</p>","extra":{"xMetaComment":"// @run-at document-idle"},"source":"import { runOnce, addStyle, runAt } from '@bext/util';\nimport { getBextBar } from '@bext/ui';\n\nrunOnce(() => {\n    let style = null;\n    runAt('document-idle', function () {\n        getBextBar().add('gray', {\n            text: '纪念模式',\n            textcolor: 'white',\n            backcolor: 'deepskyblue',\n            callback: (bar) => {\n                let button = bar.query('gray');\n                if (typeof button!=='object') return;\n                if (button.backcolor == 'deepskyblue') {\n                    style = addStyle(':root { filter : grayscale(1) !important; }');\n                    bar.change('gray', {\n                        backcolor: 'black'\n                    });\n                } else {\n                    style.remove();\n                    bar.change('gray', {\n                        backcolor: 'deepskyblue'\n                    });\n                }\n            },\n        })\n    })\n})"}