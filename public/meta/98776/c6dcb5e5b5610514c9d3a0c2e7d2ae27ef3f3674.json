{"type":"javascript","name":"到顶到底 bextBar 版","version":"5","tags":["工具脚本"],"synopsis":"bextBar 版本的 到顶到底 实现","detail":"<p class=\"ql-align-center\">bextBar 示例脚本，增加 <span style=\"background-color: rgb(102, 185, 102); color: rgb(255, 255, 255);\"> ⬆ </span> <span style=\"background-color: rgb(102, 185, 102); color: rgb(255, 255, 255);\"> ⬇ </span> 两个按钮。</p><p class=\"ql-align-center\">由于可滚动元素完全按高度判断，</p><p class=\"ql-align-center\">所以可能会同时滚动很多元素。</p><p class=\"ql-align-center\"><br></p><p class=\"ql-align-center\">这个脚本运行需要 WebView 51+ 内核，</p><p class=\"ql-align-center\">平滑滚动需要 WebView 61+ 内核。</p><p class=\"ql-align-center\">且无法运行于 CSP 限制注入样式的页面。</p>","extra":{"xMetaComment":"// @run-at document-idle"},"source":"import { runOnce, runAt } from '@bext/util';\nimport { getBextBar } from '@bext/ui';\n\nrunOnce(() => {\n    runAt('document-idle', () => {\n        let bodys = document.querySelectorAll(':root,body,body *:not(aside,hr,br,wbr,button,input,progress,meter,select,option,optgroup,dialog,map,area)'),\n            bar = getBextBar(), scroller = top => {\n                bodys.forEach(bo => {\n                    let bost = getComputedStyle(bo);\n                    if (window.innerHeight < bo.scrollHeight) {\n                        let toplen = top ? 0 : parseInt(bost.height);\n                        if (!bo.scrollTo) {\n                            bo.scrollTop = toplen;\n                        } else {\n                            bo.scrollTo({ top: toplen, behavior: 'smooth' });\n                        }\n                    }\n                })\n            };\n        bar.add('scrollby_top', {\n            text: '⬆',\n            callback: scroller.bind(this, true),\n            textcolor: 'white',\n            backcolor: 'turquoise'\n        });\n        bar.add('scrollby_bottom', {\n            text: '⬇',\n            callback: scroller.bind(this, false),\n            textcolor: 'white',\n            backcolor: 'turquoise'\n        });\n    })\n})"}