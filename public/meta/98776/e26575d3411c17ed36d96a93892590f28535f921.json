{"type":"javascript","name":"到顶到底 bextButton 版","version":"6","tags":["工具脚本"],"synopsis":"bextButton 版本的 到顶到底 实现","detail":"<p class=\"ql-align-center\">bextButton 示例脚本，增加 <span style=\"background-color: rgb(102, 185, 102); color: rgb(255, 255, 255);\"> ◆ </span> 按钮。</p><p class=\"ql-align-center\">上下拖拽按钮即可到顶到底。</p><p class=\"ql-align-center\">由于可滚动元素完全按高度判断，</p><p class=\"ql-align-center\">所以可能会同时滚动很多元素。</p><p class=\"ql-align-center\"><br></p><p class=\"ql-align-center\">这个脚本运行需要 WebView 51+ 内核，</p><p class=\"ql-align-center\">平滑滚动需要 WebView 61+ 内核。</p><p class=\"ql-align-center\">且无法运行于 CSP 限制注入样式的页面。</p>","extra":{"xMetaComment":"// @run-at document-idle"},"source":"import { runOnce } from '@bext/util';\nimport { bextButton } from '@bext/ui';\n\nrunOnce(() => {\n    let scroller = (top, btn) => {\n        document.querySelectorAll(':root,body,body *:not(aside,hr,br,wbr,button,input,progress,meter,select,option,optgroup,dialog,map,area)').forEach(bo => {\n            if (window.innerHeight < bo.scrollHeight) {\n                let toplen = top ? 0 : bo.scrollHeight;\n                if (!bo.scrollTo) {\n                    bo.scrollTop = toplen;\n                } else {\n                    bo.scrollTo({ top: toplen, behavior: 'smooth' });\n                }\n            }\n        });\n        btn.text = top ? '▲' : '▼';\n    };\n    let button = bextButton({\n        text: '◆',\n        btnColor: 'darkturquoise',\n        textColor: 'white',\n        posY: 'middle',\n        drag: (btn, e) => {\n            scroller.call(this, (e.changedTouches[0].clientY > (window.innerHeight / 2)), btn);\n            setTimeout(btn => {\n                btn.text = '◆';\n                btn.posX = 'right';\n                btn.posY = 'middle';\n            }, 300, btn);\n        }\n    });\n    button.push();\n})"}