{"versions":[{"hash":"6d9518937fcd3c5c480722fd12ff1ad4ff92668a","date":1642434818,"message":"chore: 移除 Meta::build","author_name":"ikkz","author_email":"miles_yang@foxmail.com","version":"2"},{"hash":"f31ee0fdc5434feac7503f61b00aff8e1ad2dd25","date":1641021952,"message":"屏蔽首页广告","author_name":"damengzhu","author_email":"80020206+damengzhu@users.noreply.github.com","version":"2"},{"hash":"d603c044f720e33f0d9f72366c7bdb3ff2411f4a","date":1640096863,"message":"新增去广告 1234502.json","author_name":"damengzhu","author_email":"80020206+damengzhu@users.noreply.github.com","version":"2"},{"hash":"f7938dc523326ced9e308cc074ce29f3d9e96ea7","date":1639299132,"message":"恢复已授权脚本","author_name":"ikkz","author_email":"miles_yang@foxmail.com","version":"1"},{"hash":"6d23db4cc3d026cc689a071437a57e1a9daffef3","date":1639281476,"message":"fix: 隐藏待确认脚本","author_name":"LeiLeiLei","author_email":"miles_yang@foxmail.com","version":"删除记录"},{"hash":"f374c9c623b6b32b70b4c1ef027d739209cfb126","date":1639270689,"message":"知乎直接看 1234502.json","author_name":"damengzhu","author_email":"80020206+damengzhu@users.noreply.github.com","version":"1"}],"meta":{"type":"javascript","match":["www.zhihu.com"],"name":"知乎直接看","version":"2","tags":["工具脚本"],"synopsis":"不用打开app就能看知乎回答、看评论，去广告","extra":{"xMetaComment":"// @run-at document-start\n// @type bookmarklet"},"source":"\n(function () {\n  /* 判断是否该执行 */\n  const whiteList = ['zhihu.com'];\n  const hostname = window.location.hostname;\n  const key = encodeURIComponent('谷花泰:知乎直接看:执行判断');\n\n  const result = whiteList.some(site => {\n    if (hostname.match(site)) {\n      return true;\n    }\n    return false;\n  });\n\n  if (!result || window[key]) {\n    return;\n  };\n\n  window[key] = true;\n\n  /* 代码正文 */\n  Object.defineProperties(window.navigator, {\n    'userAgent': {\n      enumerable: true,\n      value: 'Mozilla/5.0 (Windows Phone 10)'\n    },\n    'appVersion': {\n      enumerable: true,\n      value: '5.0 (Windows Phone 10)'\n    },\n    'platform': {\n      enumerable: true,\n      value: 'Win32'\n    }\n  });\n  class FixView {\n    constructor() {\n      this.init();\n    };\n    init() {\n      this.removeDownApp();\n      const search = document.querySelector('.MobileAppHeader-searchBox');\n      !search && this.addSearch();\n    };\n    addSearch() {\n      const menu = document.querySelector('.MobileAppHeader-actions');\n      const searchBox = document.createElement('div');\n      const search = document.createElement('div');\n      searchBox.setAttribute('style', `\n        width: 100%;\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      `);\n      searchBox.className = 'via-zhihu-search';\n      search.setAttribute('style', `\n        width: 80%;\n        height: 32px;\n        border-radius: 20px;\n        border: 1px solid #ebebeb;\n        background-color: rgba(235, 235, 235, 0.7);\n        display: flex;\n        align-items: center;\n        padding-left: 10px;\n      `);\n      search.addEventListener('click', () => {\n        location.href = 'https://www.zhihu.com/search?type=content&q=';\n      }, true);\n      search.innerHTML = this.getSearchSvg();\n      searchBox.appendChild(search);\n      menu.parentNode.insertBefore(searchBox, menu);\n    };\n    getSearchSvg() {\n      return `<svg class=\"Zi Zi--Search\" fill=\"#999\" viewBox=\"0 0 24 24\" width=\"18\" height=\"18\"><path d=\"M17.068 15.58a8.377 8.377 0 0 0 1.774-5.159 8.421 8.421 0 1 0-8.42 8.421 8.38 8.38 0 0 0 5.158-1.774l3.879 3.88c.957.573 2.131-.464 1.488-1.49l-3.879-3.878zm-6.647 1.157a6.323 6.323 0 0 1-6.316-6.316 6.323 6.323 0 0 1 6.316-6.316 6.323 6.323 0 0 1 6.316 6.316 6.323 6.323 0 0 1-6.316 6.316z\" fill-rule=\"evenodd\"></path></svg>`;\n    };\n    removeDownApp() {\n      const style = document.querySelector('style');\n      style.innerHTML += `\n        .MobileAppHeader-downloadLink {\n          display: none !important;\n        }\n      `;\n    };\n  };\n  function observe({ targetNode, config = {}, callback = () => { } }) {\n    if (!targetNode) {\n      return;\n    };\n\n    config = Object.assign({\n      attributes: true,\n      childList: true,\n      subtree: true\n    }, config);\n\n    const observer = new MutationObserver(callback);\n    observer.observe(targetNode, config);\n  };\n  try {\n    console.log('嘿嘿嘿');\n    observe({\n      targetNode: document.documentElement,\n      config: {\n        attributes: false\n      },\n      callback(mutations, observer) {\n        const mysearch = document.querySelector('.via-zhihu-search');\n        const menu = document.querySelector('.MobileAppHeader-actions');\n        const zhihuSearch = document.querySelector('.MobileAppHeader-searchBox');\n        if (!mysearch && menu && !zhihuSearch) {\n          new FixView();\n        };\n      }\n    });\n  } catch (err) {\n    console.log('知乎直接看：', err)\n  };\n})();\n(function(){\nfunction remove(sel) {\n  document.querySelectorAll(sel).forEach( a => a.remove());\n}\nvar g_times = 0;\nfunction myfun() {\nfunction removeads() {\nremove(\"DIV.AdvertImg.AdvertImg--isLoaded.MBannerAd-image\");\nremove(\"DIV.Banner-adTag\");\nremove(\"div.MBannerAd-third\");\nremove(\"a.MHotFeedAd\");\nremove(\"div.Pc-feedAd-container.Pc-feedAd-container--mobile\");\n}\nremoveads();\nwindow.setTimeout(removeads);\n if(g_times >= 10) {\n   window.clearInterval(timer);\n }\n g_times ++;\n}\nvar timer = setInterval(myfun,250);\nmyfun();\n})();","detail":"已获得“知乎直接看”作者谷花泰授权"},"hash":"6d9518937fcd3c5c480722fd12ff1ad4ff92668a"}