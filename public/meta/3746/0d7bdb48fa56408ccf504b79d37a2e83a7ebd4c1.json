{"type":"javascript","name":"替换蓝奏云域名","version":"1","tags":["工具脚本"],"synopsis":"替换蓝奏云失效域名，重定向到正常域名","detail":"<p>这个脚本在检测到错误页面 ( chrome-error://chromewebdata/ ) 后，提取当前地址域名。如果是<span style=\"color: rgb(102, 163, 224);\">失效域名</span>列表的其中一个域名的话，把它替换成<span style=\"color: rgb(102, 163, 224);\">正常域名</span>，然后跳转到正常地址。</p><p>注意事项：</p><p><br></p><ol><li>这个脚本会在页面加载 100 毫秒后开始执行。如果你那边没有正常跳转，请尝试将&nbsp;<span style=\"color: rgb(102, 163, 224);\">加载延时</span>&nbsp;改的更大一些。</li><li>由于 X 浏览器 不支持在错误页面执行脚本，所以&nbsp;<strong>X 浏览器目前无法使用这个脚本</strong>。</li></ol><p><br></p>","source":"import { runOnce, runAt } from '@bext/util';\nimport config from '@bext/config';\nrunOnce(() => {\n    runAt(\"document-idle\", config => {\n        if (location.href === 'chrome-error://chromewebdata/') {\n            setTimeout(config => {\n                let a = document.querySelector('a');\n                a = (a) ? a.href : document.querySelector('strong').innerHTML;\n                a = new URL(a);\n                config.bad.forEach( d => {\n                    if (a.hostname.indexOf(d)>=0) location.href = a.href.replace(d,config.good);\n                });\n            }, config.delay, config);\n        }\n    }, config)\n})","configSchema":{"type":"object","properties":{"delay":{"type":"number","title":"加载延时","default":"100"},"good":{"type":"string","title":"正常域名","default":"lanzoui.com","pattern":"^(\\w+)+\\.\\w+$"},"bad":{"type":"array","items":{"type":"string","title":"失效域名","pattern":"^(\\w+)+\\.\\w+$"},"title":"失效域名列表"}},"required":["delay","good","bad"]},"defaultConfig":{"delay":100,"good":"lanzoui.com","bad":["lanzous.com","lanzoux.com"]}}