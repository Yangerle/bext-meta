{"type":"javascript","name":"划词菜单(搜索+翻译+转到)","version":"1","synopsis":"划词搜索、划词翻译、网址跳转","tags":["其他脚本"],"detail":"<p>搬运自 <a href=\"http://via-app.cn/#/pluginDetail/17\" rel=\"noopener noreferrer\">Via 轻插件</a> ，作者 <a href=\"http://via-app.cn/#/user/10\" rel=\"noopener noreferrer\">达蒙山</a></p><p>对原脚本进行如下修改 ：</p><ol><li>适配本站安装选项</li></ol><p>以下是原版介绍 ：</p><p><br></p><p>支持添加多个搜索和翻译接口</p><p><br></p><p>支持自动提取网址，多个网址默认跳转第一个</p><p><br></p><p>建议反馈，<a href=\"https://www.coolapk.com/feed/8968220?shareKey=OGQxOWZjNzQ4ZDVhNWU5YjE0N2Y~&amp;shareUid=1563443&amp;shareFrom=com.coolapk.market_10.0.4\" rel=\"noopener noreferrer\" style=\"color: rgb(240, 102, 102);\">酷安APP打开</a>可联系到我</p>","source":"/*\n * @name: 划词菜单(搜索+翻译+转到)\n * @Author: 酷安@达蒙山\n * @version: 200418.22\n * @description: 划词搜索、划词翻译、网址跳转\n * @include: *\n */\nimport config from '@bext/config';\n\n!function() {\n\n  /*搜索引擎和翻译接口，请按相同格式修改*/\n  var ssyq = config.ssyq,\n  hcTimer,\n  ljurl,\n  text;\n\n  function hccdyc() {\n    clearTimeout(hcTimer);\n    hcTimer = setTimeout(hccd, 750);\n    if (document.getElementById(\"zdan\")) {\n      document.getElementById(\"zdan\").parentNode.removeChild(document.getElementById(\"zdan\"));\n    }\n  }\n  function hccd() {\n    text = window.getSelection().toString().trim();\n\n    text ? (document.getElementById(\"hckj\").style.display = \"block\", zdcd()) : document.getElementById(\"hckj\").style.display = \"none\";\n\n  }\n\n  function tzurl(a, b) {\n    b = b || text;\n    ljurl = a + b;\n    window.open(ljurl);\n  }\n\n  function zdcd() {\n    var zdurl = text.match(/(https?:\\/\\/(\\w[\\w-]*\\.)+[A-Za-z]{2,4}(?!\\w)(:\\d+)?(\\/([\\x21-\\x7e]*[\\w\\/=])?)?|(\\w[\\w-]*\\.)+(com|cn|org|net|info|tv|cc|gov|edu)(?!\\w)(:\\d+)?(\\/([\\x21-\\x7e]*[\\w\\/=])?)?)/i)[0];\n\n    if (zdurl) {\n      var tzlj = document.createElement(\"span\");\n      tzlj.id = \"zdan\";\n      tzlj.innerHTML = \"\\u8f6c\\u5230\";\n      tzlj.addEventListener(\"click\",\n      function() {\n\n        zdurl.indexOf(\"http\") < 0 ? tzurl(\"https://\", zdurl) : tzurl(\"\", zdurl);\n\n      });\n      document.getElementById(\"hckj\").appendChild(tzlj);\n    }\n  }\n\n  if (!document.getElementById(\"cdkj\")) {\n    var cddiv = document.createElement(\"div\");\n    cddiv.id = \"cdkj\";\n    cddiv.style.cssText = \"display:block!important;width:100%;position:fixed;bottom:0px;z-index:9999999999;text-align:center;margin:4px auto;padding:4px;-webkit-tap-highlight-color:rgba(0,0,0,0);\";\n    document.body.appendChild(cddiv);\n    var cdstyle = document.createElement(\"style\");\n    cdstyle.type = \"text/css\";\n    cdstyle.innerHTML = \"#cdkj span{display:inline-block;background:#6a6a6a;color:#fff;font-size:20px;line-height:24px;margin:4px;padding:4px;border:1px solid #c5c5c5;border-radius:5px;}\";\n    document.body.appendChild(cdstyle);\n  }\n  var hcdiv = document.createElement(\"div\");\n  hcdiv.id = \"hckj\";\n  hcdiv.style.cssText = \"display:none\";\n  document.getElementById(\"cdkj\").appendChild(hcdiv);\n\n  for (var i = 0; i < ssyq.length; i++) {\n    var jksp = document.createElement(\"span\");\n    jksp.innerHTML = ssyq[i].name;\n    jksp.setAttribute(\"jkdz\", ssyq[i].url);\n    jksp.onclick = function() {\n      tzurl(this.getAttribute(\"jkdz\"));\n    };\n    document.getElementById(\"hckj\").appendChild(jksp);\n  }\n\n  document.addEventListener(\"selectionchange\", hccdyc);\n\n} ();","configSchema":{"type":"object","properties":{"ssyq":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","title":"名称"},"url":{"type":"string","title":"地址"}},"required":["name","url"]},"title":"搜索引擎"}},"required":[]},"defaultConfig":{"ssyq":[{"name":"百度搜索","url":"https://www.baidu.com/s?wd="},{"name":"夸克搜索","url":"https://quark.sm.cn/s?q="},{"name":"百度翻译","url":"https://fanyi.baidu.com/?tpltype=sigma#zd/zd/"},{"name":"夸克翻译","url":"https://quark.sm.cn/api/rest?method=quark_fanyi.dlpage&schema=v2&format=html&entry=fanyi_jinshan#zd/zd/"}]}}